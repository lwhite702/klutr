{"version":3,"sources":["turbopack:///[project]/app/(app)/spark/page.tsx","turbopack:///[project]/lib/hooks/useSpark.ts"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { AppShell } from \"@/components/layout/AppShell\";\nimport { useSpark } from \"@/lib/hooks/useSpark\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\n\nexport default function SparkPage() {\n  const [noteId, setNoteId] = useState(\"\");\n  const [prompt, setPrompt] = useState(\"\");\n  const { runSpark, loading, response, error, clearResponse } = useSpark();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!noteId || !prompt) return;\n    await runSpark(noteId, prompt);\n  };\n\n  return (\n    <AppShell activeRoute=\"/app/spark\">\n      <div className=\"max-w-2xl mx-auto py-12 px-4\">\n        <h1 className=\"text-3xl font-display text-[#ff6b6b] mb-6\">Spark</h1>\n        <p className=\"text-slate-400 font-body mb-8\">\n          Your contextual AI partner. Analyze and expand on your notes with\n          thoughtful insights.\n        </p>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4 mb-6\">\n          <div>\n            <label\n              htmlFor=\"noteId\"\n              className=\"block text-sm font-medium text-foreground mb-2\"\n            >\n              Note ID\n            </label>\n            <Input\n              id=\"noteId\"\n              type=\"text\"\n              placeholder=\"Enter note ID...\"\n              value={noteId}\n              onChange={(e) => setNoteId(e.target.value)}\n              disabled={loading}\n              className=\"w-full\"\n            />\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"prompt\"\n              className=\"block text-sm font-medium text-foreground mb-2\"\n            >\n              Ask Spark\n            </label>\n            <Input\n              id=\"prompt\"\n              type=\"text\"\n              placeholder=\"What would you like to explore about this note?\"\n              value={prompt}\n              onChange={(e) => setPrompt(e.target.value)}\n              disabled={loading}\n              className=\"w-full\"\n            />\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              type=\"submit\"\n              disabled={loading || !noteId || !prompt}\n              className=\"bg-[#ff6b6b] hover:bg-[#ff6b6b]/90 text-white\"\n            >\n              {loading ? \"Thinking...\" : \"Run Spark\"}\n            </Button>\n            {(response || error) && (\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={clearResponse}\n                disabled={loading}\n              >\n                Clear\n              </Button>\n            )}\n          </div>\n        </form>\n\n        {error && (\n          <div className=\"mb-4 p-4 bg-destructive/10 border border-destructive/20 rounded-md\">\n            <p className=\"text-destructive text-sm\">{error}</p>\n          </div>\n        )}\n\n        {response && (\n          <div className=\"mt-6 p-6 bg-slate-900/50 border border-slate-700 rounded-lg\">\n            <h2 className=\"text-lg font-display text-[#ff6b6b] mb-3\">\n              Response\n            </h2>\n            <div className=\"text-slate-300 font-body whitespace-pre-line leading-relaxed\">\n              {response}\n              {loading && (\n                <span className=\"inline-block w-2 h-4 bg-[#ff6b6b] ml-1 animate-pulse\" />\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </AppShell>\n  );\n}\n","import { useState } from 'react'\n\ninterface UseSparkReturn {\n  loading: boolean\n  response: string\n  error: string | null\n  runSpark: (noteId: string, prompt: string) => Promise<void>\n  clearResponse: () => void\n}\n\n/**\n * Hook for interacting with Spark AI assistant\n * Handles streaming responses from /api/spark endpoint\n */\nexport function useSpark(): UseSparkReturn {\n  const [loading, setLoading] = useState(false)\n  const [response, setResponse] = useState('')\n  const [error, setError] = useState<string | null>(null)\n\n  async function runSpark(noteId: string, prompt: string) {\n    if (!noteId || !prompt) {\n      setError('Note ID and prompt are required')\n      return\n    }\n\n    setLoading(true)\n    setResponse('')\n    setError(null)\n\n    try {\n      const res = await fetch('/api/spark', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ noteId, prompt }),\n      })\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: 'Unknown error' }))\n        throw new Error(errorData.error || `HTTP ${res.status}`)\n      }\n\n      if (!res.body) {\n        throw new Error('Response body is null')\n      }\n\n      const reader = res.body.getReader()\n      const decoder = new TextDecoder()\n\n      while (true) {\n        const { done, value } = await reader.read()\n        if (done) break\n\n        const chunk = decoder.decode(value, { stream: true })\n        setResponse((prev) => prev + chunk)\n      }\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to run Spark'\n      setError(errorMessage)\n      console.error('[useSpark] Error:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  function clearResponse() {\n    setResponse('')\n    setError(null)\n  }\n\n  return { loading, response, error, runSpark, clearResponse }\n}\n\n"],"names":[],"mappings":"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"}